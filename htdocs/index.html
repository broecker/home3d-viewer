<!DOCTYPE html>
<html>
<head>
	<title>Hello Pointcloud!!</title>

	<!-- look here: http://css3buttongenerator.com/ -->

	<style>
	html, body {
		padding: 0px;
		margin: 0px;
		width: 100%;
		height: 100%;
		overflow: hidden;
	}

	.btn {
		background:rgba(52, 152,219, 0.4);
		font-family: Arial;
		color: #ffffff;
		font-size: 15px;
		border: solid #c40c40 0px;
		padding: 6px 20px 6px 20px;
	}

	.btn:hover {
		background:rgba(60,176,253, 0.9);
		text-decoration: none;
	}

	.buttonBar { 
		float:left;
		position: absolute;
		left: 10px;
		top: 10px;
		z-index: 100;
	}


	
	canvas {
		position: relative;
		width: 100%;
		height: 100%;
		z-index: 0;
	}
	
	


	</style>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<meta name="viewport" content="width=device-width, initial-scale=1">


	<script id="pointVS" type="x-shader/x-vertex">
		attribute vec3 positionIn;
		attribute vec3 colorIn;

		uniform mat4 viewMatrix;
		uniform mat4 projMatrix;

		uniform float pointSize;

		varying vec3 color;
		void main()
		{
			gl_Position = projMatrix * viewMatrix * vec4(positionIn, 1.0);
			
			gl_PointSize = pointSize;
			color = colorIn;
		
			
			vec3 red = vec3(0.8, 0.0, 0.0);
			vec3 grn = vec3(0.0, 0.7, 0.0);

			//color = mix(grn, red, (pointSize-minPointSize) / (maxPointSize-minPointSize));
			
			

		}
	</script>
	
	<script id="pointFS" type="x-shader/x-fragment">
		precision mediump float;

		varying vec3 color;


		
		void main()
		{
			// this enables round point sprites in OpenGL ES2			
			vec2 pt = gl_PointCoord - vec2(0.5);
			if(dot(pt, pt) > 0.25)
    			discard;

			gl_FragColor = vec4(color, 1.0);
		}
	</script>
	
	
	<script id="gridVS" type="x-shader/x-vertex">
	  attribute vec3 positionIn;
	  
	  uniform mat4 viewMatrix;
	  uniform mat4 projMatrix;
	  
	  void main()
	  {
	    gl_Position = projMatrix * viewMatrix * vec4(positionIn, 1.0);
	    gl_PointSize = 1.0;
	    
	  }
	</script>
	
	<script id="gridFS" type="x-shader/x-fragment">
	  precision mediump float;
	  uniform vec3 color;
	  
	  void main()
	  {
	    gl_FragColor = vec4(color, 1.0);
	  }
	</script>

	<script id="objectVS" type="x-shader/x-vertex">
	  attribute vec3 positionIn;
	  attribute vec3 colorIn;

	  uniform mat4 viewMatrix;
	  uniform mat4 projMatrix;
	  
	  varying vec3 color;

	  void main()
	  {
	    gl_Position = projMatrix * viewMatrix * vec4(positionIn, 1.0);
	    color = colorIn;
	  }
	</script>


	<script id="objectFS" type="x-shader/x-fragment">
	  precision mediump float;
	  varying vec3 color;
	  
	  void main()
	  {
	    gl_FragColor = vec4(color, 1.0);
	  }
	</script>	


	<script id="quadVS" type="x-shader/x-vertex">

		attribute vec2 positionIn;
		varying vec2 texcoords;

		void main()
		{

			gl_Position = vec4(positionIn*2.0 - vec2(1.0), 0.0, 1.0);
			texcoords = positionIn.xy;

		}
	</script>

	<script id = "quadFS" type="x-shader/x-fragment">
		precision mediump float;

		uniform sampler2D colormap;
		varying vec2 texcoords;


		void main()
		{
			gl_FragColor = texture2D(colormap, texcoords);

		}

	</script>


	<script id="skyboxVS" type="x-shader/x-vertex">
		attribute vec2 positionIn;
		varying vec2 texcoords;
		varying vec3 viewDir;

		uniform mat4 inverseMVP;

		void main()
		{

			vec4 worldPos = inverseMVP * vec4(positionIn, 1.0, 1.0);
			worldPos /= worldPos.w;

			vec4 cameraPos = inverseMVP * vec4(0.0, 0.0, 0.0, 1.0);
			cameraPos /= cameraPos.w;

			viewDir = worldPos.xyz - cameraPos.xyz; 

			gl_Position = vec4(positionIn*2.0 - vec2(1.0), 0.0, 1.0);
			texcoords = positionIn.xy;

		}
	</script>

	<script id = "skyboxFS" type="x-shader/x-fragment">
		precision mediump float;

		varying vec2 texcoords;
		varying vec3 viewDir;


		void main()
		{
			vec3 V = normalize(viewDir);

			vec3 horizonColor = vec3(0.8, 0.8, 0.9);
			vec3 bottomColor = vec3(0.3, 0.3, 0.4);
			vec3 topColor = vec3(0.6, 0.6, 1.0);

			vec3 color = V;

			if (V.y > 0.0)
				color = mix(horizonColor, topColor, V.y);
			else
				color = mix(horizonColor, bottomColor, -V.y);


			gl_FragColor = vec4(color, 1.0);

		}

	</script>


	<script src="scripts/gl-matrix.js"></script>
	<script src="scripts/aabb.js"></script>
	<script src="scripts/camera.js"></script>
	<script src="scripts/octree.js"></script>
	<script src="scripts/ray.js"></script>
	<script src="scripts/stats.js"></script>
	<script src="scripts/shader.js"></script>
	<script src="scripts/geometry.js"></script>
	<script src="scripts/dat-gui.js"></script>
	<script src="scripts/framebuffer.js"></script>
	<script src="scripts/main.js"></script>
	<script src='scripts/nprogress.js'></script>

	<link rel='stylesheet' href='styles/nprogress.css'/>

</head>
	<body onload="main('http://10.129.29.219:8000/son/son.json')" >
	<canvas id="canvas" width="800" height="600"></canvas>

	<div class="buttonBar">
		<button type="button" class="btn" onclick="toggleGrid()">Toggle Grid</button>
		<button type="button" class="btn" onclick="toggleBBox()">Toggle BBox</button>
		<button type="button" class="btn" onclick="resetCamera()">Reset Camera</button>
		<button type="button" class="btn" onclick="increaseRecursion()">Increase Detail</button>
		<button type="button" class="btn" onclick="decreaseRecursion()">Decrease Detail</button>
	</div>

</body>
</html>